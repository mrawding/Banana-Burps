<!DOCTYPE html>
<html>
  <head>
    <style>
      .hidden {
        display: none;
      }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
  </head>
  <body>
    <h1>Welcome to Banana Burps</h1>
    <h2> Score: </h2>
    <span id = "score">
    </span>
    <span id="timer">Time:
    <span id="time">60</span>
      
    </span>
    <span id = "word"></span>
    <button id="start">Start</button>
        <span id="bingos">
        </span>
      <br>
      <input type="text" id="entry" />
      <button id="enter">Enter</button>
      </br>
        
  </body>
  <script>
 
    $(document).ready(function(){
    var words ={};
     $("#start").on("click", function(){
    //    $.ajax({
      //      method: "GET",
        //    url: "api.php",
          //  success: data=> words
          //});
        
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
           words = JSON.parse(this.responseText);
           document.getElementById("bingos").innerHTML = words[2];
          }
        };
        xmlhttp.open("GET", "api.php", true);
        xmlhttp.send(); 
        startGame(words);
        });
      
     let startGame = function(words){
        var input = document.getElementById('entry');
        var counter = 60.0;
        var score = 0.0;
        updateScore(score);
        var interval = setInterval(function() {
        counter -= 0.1;
        if (counter <= 0) {
          return;
         }
        else{
        	$('#time').text(counter.toFixed(1));
          input.addEventListener('keyup',function(){
            $("#bingos").text(input);
            if(findMatch(words,input)){
             // score += (input.length)*100;
              //updateScore(score);
            }     
         });
          findMatch(words,input);
        }
        },100); 
         }
        
      
     let findMatch = function(words, input){
         var i;
          for(i =0;i<words.length;i++){
              var j;
              for(j = 0;j < words[j].length; j++){
                if(words[i][j] == input.toString().toUpperCase()){
                  $("#word").text(words[i][j]);
                  
                  return true;
                }
              }
          }
        return false;
      }
      let updateScore = function(score){
         $("#score").html('');
         $("#score").append(score);
      }
        
      
          
     
    });
     
  </script>
</html>
